# Pregel æ˜¯å¦éœ€è¦ pending_writes æœºåˆ¶åˆ†æ

## æ¦‚è¿°

æœ¬æ–‡æ¡£åˆ†ææˆ‘ä»¬æ˜¯å¦éœ€è¦åƒ LangGraph é‚£æ ·çš„ `pending_writes` æœºåˆ¶æ¥ä¿è¯ä»é”™è¯¯ä¸­æ¢å¤ã€‚

## 1. LangGraph pending_writes çš„ä½œç”¨

```
å¹¶è¡Œæ‰§è¡Œåœºæ™¯ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node A  â”‚     â”‚ Node B  â”‚     â”‚ Node C  â”‚
â”‚   âœ…    â”‚     â”‚   âŒ    â”‚     â”‚   âœ…    â”‚
â”‚ å®Œæˆ    â”‚     â”‚  å¤±è´¥   â”‚     â”‚ å®Œæˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
         pending_writes = [
           {node_a, result_a},
           {node_c, result_c}
         ]

æ¢å¤æ—¶ï¼šåªéœ€é‡æ–°æ‰§è¡Œ Node B
```

LangGraph çš„ `pending_writes` ç”¨äºï¼š
- è®°å½•å¹¶è¡ŒèŠ‚ç‚¹çš„éƒ¨åˆ†å®Œæˆç»“æœ
- æŒä¹…åŒ–åˆ° checkpoint
- æ”¯æŒä»å¤±è´¥ä¸­æ¢å¤ï¼Œè·³è¿‡å·²å®ŒæˆèŠ‚ç‚¹

## 2. ä¸¤ç§é”™è¯¯æ¢å¤åœºæ™¯

### åœºæ™¯ 1ï¼šå†…å­˜ä¸­é‡è¯•ï¼ˆå½“å‰è¶…æ­¥å†…ï¼‰

```
è¶…çº§æ­¥ N æ‰§è¡Œä¸­:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Worker å†…éƒ¨                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ç¬¬ä¸€è½®æ‰§è¡Œ:                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ Node A  â”‚  â”‚ Node B  â”‚  â”‚ Node C  â”‚                         â”‚
â”‚  â”‚   âœ…    â”‚  â”‚   âŒ    â”‚  â”‚   âœ…    â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚       â”‚            â”‚            â”‚                               â”‚
â”‚       â–¼            â–¼            â–¼                               â”‚
â”‚  superstep_state = #{                                           â”‚
â”‚    node_a => #{status => completed, vertex => V1, outbox => O1},â”‚
â”‚    node_b => #{status => failed, error => Reason},              â”‚ â† å†…å­˜ä¸­è®°å½•
â”‚    node_c => #{status => completed, vertex => V3, outbox => O3} â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â”‚  ç¬¬äºŒè½®é‡è¯•:                                                     â”‚
â”‚  åªé‡è¯• node_bï¼Œå¤ç”¨ node_aã€node_c çš„ç»“æœ                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¿™ç§åœºæ™¯ä¸éœ€è¦ `pending_writes`**ï¼Œå› ä¸ºï¼š
- ç»“æœä¿å­˜åœ¨è¿›ç¨‹å†…å­˜ä¸­
- ä¸éœ€è¦æŒä¹…åŒ–
- `superstep_state` åœ¨ Worker å†…å­˜ä¸­è¶³å¤Ÿ

### åœºæ™¯ 2ï¼šè·¨è¿›ç¨‹/æŒä¹…åŒ–æ¢å¤

```
è¶…çº§æ­¥ N æ‰§è¡Œä¸­ï¼ŒWorker è¿›ç¨‹å´©æºƒ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡Œåˆ°ä¸€åŠæ—¶ Worker è¿›ç¨‹å´©æºƒ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ Node A  â”‚  â”‚ Node B  â”‚  â”‚ Node C  â”‚                         â”‚
â”‚  â”‚   âœ…    â”‚  â”‚ æ‰§è¡Œä¸­ğŸ’¥ â”‚  â”‚  å¾…æ‰§è¡Œ  â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚       â”‚            â”‚                                            â”‚
â”‚       â”‚      Worker å´©æºƒ                                        â”‚
â”‚       â”‚      å†…å­˜ä¸¢å¤±ï¼                                          â”‚
â”‚       â–¼                                                         â”‚
â”‚  node_a çš„ç»“æœä¹Ÿä¸¢å¤±äº†                                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

éœ€è¦ pending_writes æŒä¹…åŒ–:

pending_writes = [
  {node_a, channel, result_a}  â† å·²æŒä¹…åŒ–ï¼Œå¯æ¢å¤
]

æ¢å¤æ—¶ï¼š
- ä» pending_writes æ¢å¤ node_a çš„ç»“æœ
- é‡æ–°æ‰§è¡Œ node_b, node_c
```

## 3. æ˜¯å¦éœ€è¦ pending_writesï¼Ÿ

### å–å†³äºæ¢å¤éœ€æ±‚çº§åˆ«

| æ¢å¤ç±»å‹ | æ˜¯å¦éœ€è¦ pending_writes | è¯´æ˜ |
|----------|------------------------|------|
| **Level 1: Worker å†…é‡è¯•** | âŒ ä¸éœ€è¦ | `superstep_state` åœ¨å†…å­˜ä¸­è¶³å¤Ÿ |
| **Level 2: Worker å´©æºƒæ¢å¤** | âœ… éœ€è¦ | éœ€è¦æŒä¹…åŒ–éƒ¨åˆ†å®Œæˆç»“æœ |
| **Level 3: è¶…çº§æ­¥çº§ Checkpoint** | âœ… éœ€è¦ | éœ€è¦è®°å½•è¶…æ­¥å†…çš„ä¸­é—´çŠ¶æ€ |
| **Level 4: æ•´å›¾çº§ Checkpoint** | âŒ ä¸éœ€è¦ | åªåœ¨è¶…æ­¥å®Œæˆåä¿å­˜ï¼ˆå½“å‰å®ç°ï¼‰ |

### æ¢å¤éœ€æ±‚å±‚çº§å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ¢å¤éœ€æ±‚å±‚çº§                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Level 1: å•é¡¶ç‚¹é‡è¯•ï¼ˆåŒä¸€è¶…æ­¥å†…ï¼‰                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  éœ€è¦: superstep_stateï¼ˆå†…å­˜ï¼‰                                   â”‚
â”‚  ä½ç½®: Worker è¿›ç¨‹                                               â”‚
â”‚  å®ç°: pregel_single_vertex_restart.md è®¾è®¡                     â”‚
â”‚  pending_writes: âŒ ä¸éœ€è¦                                      â”‚
â”‚                                                                 â”‚
â”‚  Level 2: Worker å´©æºƒæ¢å¤                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  éœ€è¦: pending_writesï¼ˆæŒä¹…åŒ–ï¼‰                                  â”‚
â”‚  ä½ç½®: å¤–éƒ¨å­˜å‚¨                                                  â”‚
â”‚  å®ç°: éœ€è¦æ–°å¢                                                  â”‚
â”‚  pending_writes: âœ… éœ€è¦                                        â”‚
â”‚                                                                 â”‚
â”‚  Level 3: è¶…æ­¥çº§ Checkpoint                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚  éœ€è¦: superstep_checkpoint + pending_writes                    â”‚
â”‚  ä½ç½®: å¤–éƒ¨å­˜å‚¨                                                  â”‚
â”‚  å®ç°: éœ€è¦æ–°å¢                                                  â”‚
â”‚  pending_writes: âœ… éœ€è¦                                        â”‚
â”‚                                                                 â”‚
â”‚  Level 4: æ•´å›¾çº§ Checkpointï¼ˆå½“å‰å®ç°ï¼‰                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚  éœ€è¦: è¶…æ­¥å®Œæˆåçš„å®Œæ•´çŠ¶æ€                                       â”‚
â”‚  ä½ç½®: beamai_agent_checkpoint.erl                              â”‚
â”‚  pending_writes: âŒ ä¸éœ€è¦                                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. superstep_state çš„ä½ç½®

**superstep_state åº”è¯¥åœ¨ Worker è¿›ç¨‹ä¸­**ï¼Œä¸æ˜¯ Masterã€‚

### åŸå› 

| æ–¹é¢ | Worker | Master |
|------|--------|--------|
| **æ‰§è¡Œé¡¶ç‚¹** | âœ… æ˜¯ | âŒ å¦ |
| **ç®¡ç†æœ¬åœ°é¡¶ç‚¹** | âœ… æ˜¯ | âŒ å¦ |
| **éœ€è¦çŸ¥é“æ‰§è¡ŒçŠ¶æ€** | âœ… æ˜¯ | ä»…éœ€æ±‡æ€»ç»“æœ |
| **é‡è¯•å¤±è´¥é¡¶ç‚¹** | âœ… æ˜¯ | âŒ å¦ |

### Worker çŠ¶æ€æ‰©å±•

```erlang
-record(state, {
    worker_id     :: non_neg_integer(),
    master        :: pid(),
    vertices      :: #{vertex_id() => vertex()},
    inbox         :: #{vertex_id() => [term()]},
    compute_fn    :: fun(),
    combiner      :: pregel_combiner:spec(),
    superstep     :: non_neg_integer(),
    num_workers   :: pos_integer(),
    num_vertices  :: non_neg_integer(),
    worker_pids   :: #{non_neg_integer() => pid()},

    %% æ–°å¢ï¼šè¶…æ­¥æ‰§è¡ŒçŠ¶æ€
    superstep_state :: #{vertex_id() => vertex_result()}
}).
```

### èŒè´£åˆ†å·¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Master                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èŒè´£:                                                          â”‚
â”‚  - åè°ƒè¶…æ­¥æ‰§è¡Œ                                                  â”‚
â”‚  - ç®¡ç† Barrier åŒæ­¥                                            â”‚
â”‚  - æ”¶é›† Worker æ±‡æ€»ç»“æœ                                         â”‚
â”‚  - å†³å®šç»§ç»­/ç»ˆæ­¢                                                 â”‚
â”‚                                                                 â”‚
â”‚  ä¸å…³å¿ƒ:                                                         â”‚
â”‚  - å•ä¸ªé¡¶ç‚¹çš„æ‰§è¡ŒçŠ¶æ€                                            â”‚
â”‚  - å“ªäº›é¡¶ç‚¹æˆåŠŸ/å¤±è´¥                                             â”‚
â”‚  - é‡è¯•é€»è¾‘                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    è§¦å‘è¶…æ­¥æ‰§è¡Œ
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Worker                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èŒè´£:                                                          â”‚
â”‚  - æ‰§è¡Œæœ¬åœ°é¡¶ç‚¹è®¡ç®—                                              â”‚
â”‚  - è¿½è¸ªæ¯ä¸ªé¡¶ç‚¹çš„æ‰§è¡ŒçŠ¶æ€ (superstep_state)                      â”‚
â”‚  - é‡è¯•å¤±è´¥çš„é¡¶ç‚¹                                                â”‚
â”‚  - æ±‡æ€»ç»“æœä¸ŠæŠ¥ Master                                          â”‚
â”‚                                                                 â”‚
â”‚  superstep_state å†…å®¹:                                          â”‚
â”‚  #{                                                             â”‚
â”‚    vertex_a => #{status => completed, vertex => V, outbox => O},â”‚
â”‚    vertex_b => #{status => failed, error => Reason},            â”‚
â”‚    vertex_c => #{status => pending}                             â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. å»ºè®®å®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šåˆ†å±‚å®ç°ï¼ˆæ¨èï¼‰

```erlang
%% 1. é¦–å…ˆå®ç° Level 1ï¼šå•é¡¶ç‚¹é‡è¯•ï¼ˆå†…å­˜ä¸­ï¼‰
%%    - ä¿®æ”¹ compute_vertices æ”¯æŒ try-catch
%%    - åœ¨ Worker ä¸­æ·»åŠ  superstep_state è¿½è¸ª
%%    - æ”¯æŒé‡è¯•å¤±è´¥é¡¶ç‚¹

%% 2. å¯é€‰å®ç° Level 2/3ï¼špending_writes
%%    - ä»…å½“éœ€è¦æŒä¹…åŒ–æ¢å¤æ—¶
%%    - æ·»åŠ åˆ° superstep_checkpoint ç»“æ„ä¸­

-record(superstep_checkpoint, {
    superstep :: non_neg_integer(),
    vertices :: #{vertex_id() => vertex()},
    inbox :: #{vertex_id() => [term()]},
    pending_writes :: [{vertex_id(), term()}],  %% æ–°å¢ï¼ˆLevel 2/3ï¼‰
    metadata :: map()
}).
```

### æ–¹æ¡ˆ Bï¼šç®€åŒ–å®ç°ï¼ˆä»… Level 1ï¼‰

```erlang
%% Worker æ‰§è¡Œæµç¨‹
execute_superstep(State) ->
    %% 1. æ‰§è¡Œæ‰€æœ‰é¡¶ç‚¹ï¼Œè®°å½•ç»“æœåˆ° superstep_state
    {Results, NewSuperstepState} = compute_vertices_safe(...),

    %% 2. æ£€æŸ¥å¤±è´¥é¡¶ç‚¹
    FailedVertices = get_failed_vertices(NewSuperstepState),

    %% 3. é‡è¯•å¤±è´¥é¡¶ç‚¹ï¼ˆæœ€å¤š N æ¬¡ï¼‰
    FinalState = retry_failed_vertices(FailedVertices, NewSuperstepState, MaxRetries),

    %% 4. æ±‡æ€»ç»“æœä¸ŠæŠ¥ Master
    notify_master_done(FinalState),

    %% 5. æ¸…ç©º superstep_state å‡†å¤‡ä¸‹ä¸€è¶…æ­¥
    State#state{superstep_state = #{}}.
```

## 6. ç»“è®º

| é—®é¢˜ | å›ç­” |
|------|------|
| **æ˜¯å¦éœ€è¦ pending_writesï¼Ÿ** | å–å†³äºæ¢å¤çº§åˆ« |
| **Level 1 (å†…å­˜é‡è¯•)** | ä¸éœ€è¦ï¼Œ`superstep_state` è¶³å¤Ÿ |
| **Level 2+ (æŒä¹…åŒ–æ¢å¤)** | éœ€è¦ |
| **superstep_state ä½ç½®** | **Worker è¿›ç¨‹**ï¼ˆä¸æ˜¯ Masterï¼‰ |
| **å»ºè®®** | å…ˆå®ç° Level 1ï¼ŒæŒ‰éœ€æ‰©å±•åˆ° Level 2/3 |

**ä¼˜å…ˆå®ç° Worker å†…çš„ `superstep_state` æœºåˆ¶**ï¼Œå®ƒèƒ½è§£å†³å¤§éƒ¨åˆ†é”™è¯¯åœºæ™¯ï¼Œä¸”å®ç°ç®€å•ã€‚åªæœ‰å½“éœ€è¦è·¨è¿›ç¨‹/æŒä¹…åŒ–æ¢å¤æ—¶ï¼Œæ‰éœ€è¦å¼•å…¥ `pending_writes`ã€‚
